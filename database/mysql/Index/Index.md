# 索引

## 1.什么是索引
索引是一种提升查询效率的的***数据结构***。

### 1.2优势
通过索引对数据项进行排序,降低数据排序成本、IO成本、CPU消耗成本，提升查询效率。

### 1.3劣势
- 占用磁盘空间： 索引也是以文件形式存储到磁盘上。
- 降低表更新速度：更新表时,MySQL不仅要保存数据，还要保存一下索引文件。

## 2.索引实现模型
- 哈希表：适用于只有***等值查询***的场景，比如：Memcached。
- 有序数组：***等值查询***和***范围查询***的性能都非常优秀。
- 二叉树：二叉查找树、平衡二叉树、B树、B+树

### 2.1哈希表：
哈希表是一种以键值对存储数据的结构。在MySQL中key用于存储**索引列**，value就是某行的**数据或它的磁盘地址**。

当多个key经过**哈希函数**计算出现相同值时，这种情况下value的结构就是个**链表**。假设现在让你通过身份证号找名字，这时它的哈希表索引结构是这样的：

## 3.索引分类
### 3.1按字段特性分类：
- 主键索引：**_建立在主键字段上的索引_**。一张表只能有一个主键索引，**索引列值不允许有空值**，通常在创建表时一起创建。
- 唯一索引：**_建立在UNIQUE字段上的索引_**。一张表可以有多个唯一索引，**索引列值允许为空**，列值中出现多个空值不会发生重复冲突。
- 普通索引：建立在普通字段上的索引。
- 前缀索引：对字符类型字段前几个字符或二进制类型字段前几个bytes建立的索引。前缀索引可以建立在类型为char、varchar、binary、varbinary的列上，可以大大减少索引占用的存储空间，同时提升索引的查询效率。

### 3.2按字段个数分类
- 单列索引：**_建立在单个列上的索引_**。
- 联合索引（复合索引、组合索引）：**_建立在多个列上的索引_**。

### 3.3按物理存储分类：
MySQL索引按叶子节点存储的是否为完整表数据分为：聚簇索引、二级索引（辅助索引）。
- 聚簇索引：每个叶子节点存储一行完整的表数据。
  - InnoDB要求数据表必须有聚簇索引。
    - 默认在主键字段上建立聚簇索引。
    - 在没有主键字段的情况下，在表的第一个非空唯一索引字段上建立聚簇索引。
    - 两者都不存在的情况下，InnoDB将自动生成一个隐式的自增id列，并在该列上建立聚簇索引。

    - 
- 二级索引（辅助索引）：叶子节点不存储一行完整的表数据，而是存储聚簇索引所在列的值。

**_主键最好是自增的_**：因为二级索引存储的是储聚簇索引所在列的值(通常是主键值)。显然，主键长度越小，二级索引的叶子节点就越小，二级索引占用的空间也就越小。

自增主键如果用整型，则要4个字节，如果用长整型(bigint)则要8个字节。

**_回表查询_**：由于二级索引的叶子节点不存储完整的表数据，当通过二级索引查询到聚簇索引列值后，还需要回到聚簇索引也就是表数据本身进一步获取数据。_**因此，我们在应用中应该尽量使用主键查询**_。

### 3.4按数据结构分类：
- B+tree索引
- Hash索引
- Full-text索引

# Reference
[MySQL索引有哪些分类，你真的清楚吗？](https://segmentfault.com/a/1190000037683781)

[B树、B+树](https://segmentfault.com/a/1190000019927682?utm_source=sf-similar-article)